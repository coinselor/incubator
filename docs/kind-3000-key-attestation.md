# Kind 3000: Key Attestation

**Status:** Draft

This event kind is used to publicly attest that the owner of an external cryptographic key (from a blockchain or other system) also controls a Nostr public key. It creates a verifiable link between a Nostr identity and an external identity.

This is a **regular, non-replaceable event**. A history of attestations is maintained to provide a full audit trail. Updates are handled by a `sequence` number.

This specification incorporates [NIP-73](https://github.com/nostr-protocol/nips/blob/master/73.md) for discoverability of events associated with the external identifier.

## Content Format

The `content` field **MUST** be empty.

### Schema

```json
"content": ""
```

## Event Structure

```json
{
  "id": "<32-bytes lowercase hex-encoded sha256 of the serialized event data>",
  "pubkey": "<32-bytes lowercase hex-encoded public key of the event creator>",
  "created_at": <unix_timestamp>,
  "kind": 3000,
  "tags": [
    ["identifier", "<optional_entity_type>", "<unique_identifier>"],
    ["network", "<network_name>"],
    ["scheme", "<signature_scheme>"],
    ["sequence", "<sequence_number_string>"],
    ["signature", "<signature_from_external_key>"],
    ["i", "<network>[:<chain_id>]:address:<external_public_key>"],
    ["k", "<network>:address"],
    ["alt", "Key Attestation for <identifier> on <network>"]
  ],
  "content": "",
  "sig": "<64-bytes lowercase hex of the signature of the sha256 hash of the serialized event data, which is the same as the 'id' field>"
}
```

## Tags

| Tag Name | Description | Example Format | Required |
|----------|-------------|----------------|----------|
| `identifier` | Unique identifier, optionally with entity type | `["identifier", "PillarOne"]` or `["identifier", "pillar", "PillarOne"]` | Yes |
| `network` | Network or blockchain name | `["network", "zenon"]` | Yes |
| `scheme` | Cryptographic signature scheme | `["scheme", "ed25519"]` | Yes |
| `sequence` | Version number for updates | `["sequence", "1"]` | Yes |
| `signature` | Signature from external key | `["signature", "ea00f1ab2ad34b60080e77b431d806e9ead4a4eee36e41cf58a05859b080a03a4dc8a8b21b4952dacf5f7f97262ffdcde47132a269ca97c69260543cd0dc8604"]` | Yes |
| `i` | NIP-73 external identifier | `["i", "zenon:1:address:z1qqjnwjjpnue8xmmpanz6csze6tcmtzzdtfsww7"]` | Yes |
| `k` | NIP-73 identifier type | `["k", "zenon:address"]` | Recommended |
| `alt` | Human-readable event description | `["alt", "Key Attestation for PillarOne on Zenon Network"]` | Recommended |

### `identifier`

A unique identifier for the entity being attested. The tag has the format `["identifier", "<optional_entity_type>", "<unique_identifier>"]` where the entity type can be omitted when not needed.

The entity type provides semantic clarity by explicitly categorizing the type of entity (e.g., "organization", "username", "pillar"), while omitting it provides flexibility for cases where entity type categorization is not needed.

Examples:
- `["identifier", "PillarOne"]` - No entity type
- `["identifier", "pillar", "PillarOne"]` - With entity type

### `network`

The name of the network or blockchain where the external key originates. This provides context for which verification rules to apply.

Example: `["network", "zenon"]`, `["network", "bitcoin"]`

### `scheme`

The cryptographic signature scheme used to generate the `signature`. This is essential for clients to know how to verify the signature.

Common values include:
- `ed25519`
- `schnorr-bip340`
- `ecdsa-secp256k1`

Example: `["scheme", "ed25519"]`

### `sequence`

A strictly increasing integer (as a string) used for versioning.

Example: `["sequence", "1"]`

### `signature`

The signature generated by the private key corresponding to the external key. This signature proves ownership of the external key.

Example: `["signature", "ea00f1ab2ad34b60080e77b431d806e9ead4a4eee36e41cf58a05859b080a03a4dc8a8b21b4952dacf5f7f97262ffdcde47132a269ca97c69260543cd0dc8604"]`

### `i` and `k` (NIP-73)

These tags make the event discoverable by NIP-73 compatible clients. The `i` tag contains the full external identifier, and the `k` tag specifies the type of identifier.

- `i`: `["i", "<network>:<chain_id>:address:<external_public_key>"]`
- `k`: `["k", "<network>:address"]`

Example: `["i", "zenon:1:address:z1qqjnwjjpnue8xmmpanz6csze6tcmtzzdtfsww7"]`, `["k", "zenon:address"]`

### `alt`

A human-readable summary of the event's purpose, as per [NIP-31](https://github.com/nostr-protocol/nips/blob/master/31.md). This should be included to provide context for clients that do not understand this event kind. The `content` field **MUST** be empty.

Example: `["alt", "Key Attestation for PillarOne on Zenon Network"]`

## Client Behavior

Clients SHOULD verify the authenticity of Key Attestation events before trusting them. To verify an attestation, clients MUST perform the following steps:

1.  Construct the precise message string that was signed. The format is:
    `"nostr-key-attestation:" + <nostr_pubkey_in_hex>`
    
    Example: `"nostr-key-attestation:6e468422dfb74a5738702a8823b9b28168abab8655faacb6853cd0ee15deee93"`

2.  Extract the external address from the `i` tag and derive the corresponding public key.

3.  Using the `scheme` tag, verify the `signature` against the constructed message and the external public key.

Clients SHOULD only consider attestation events with the highest `sequence` number for each unique combination of `identifier` and `i` tag as valid.

This process ensures that the signature is unique to this protocol and cannot be replayed from other applications.

## Relay Behavior

Relays SHOULD treat Kind 3000 events as regular events and are not required to perform any special validation beyond standard Nostr event validation. Relays MAY choose to implement additional filtering or validation policies at their discretion.

## Example Event

```json
{
  "id": "4376c65d2f232afbe9b882a35baa4f6fe8667c4e684749af565f981833ed6a65",
  "pubkey": "6e468422dfb74a5738702a8823b9b28168abab8655faacb6853cd0ee15deee93",
  "created_at": 1722856642,
  "kind": 3000,
  "tags": [
    ["identifier", "pillar", "PillarOne"],
    ["network", "zenon"],
    ["scheme", "ed25519"],
    ["sequence", "1"],
    ["signature", "ea00f1ab2ad34b60080e77b431d806e9ead4a4eee36e41cf58a05859b080a03a4dc8a8b21b4952dacf5f7f97262ffdcde47132a269ca97c69260543cd0dc8604"],
    ["i", "zenon:1:address:z1qqjnwjjpnue8xmmpanz6csze6tcmtzzdtfsww7"],
    ["k", "zenon:address"],
    ["alt", "Key Attestation for pillar PillarOne on Zenon Network"]
  ],
  "content": "",
  "sig": "908a15e46fb4d8675bab026fc230a0e3542bfade63da02d542fb78b2a8513fcd0092619a2c8c1221e581946e0191f2af505dfdf8657a414dbca329186f009262"
}
```
